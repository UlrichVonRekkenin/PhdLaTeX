\section{Описание модели АНПА} \label{sec:model_anpa}
\subsection{Декомпозиция}

Исследуемый объект контроля представляет собой АНПА, предназначенный для автономного поиска скоплений плонктона,
рыбных косяков или китов под водой путем испускания специализированной зондирующей посылки и ее анализа.
АНПА заключен в металлический корпус, внутри которого располагаются следующие составные части,
как показано на рисунке \ref{fig:model_anpa}.
\begin{center}
    \begin{figure}
        % \includegraphics[width=.5\textwidth,keepaspectratio]{model_anpa}
        \caption{Декомпозиция материальной составляющей АНПА на составные части и взаимодействие между ними.}
            \label{fig:model_anpa}
    \end{figure}
\end{center}
В данной модели предполагается, что прибор управления является центральным управляющим узлом изделия,
на который возложены все функции принятия решений.

Связи \textbf{объект--функция--действие} АНПА показаны в таблицах
\ref{tbl:model_anpa_objects}, \ref{tbl:model_anpa_informations}, \ref{tbl:model_anpa_actions} \cite{journal:vestnik_igeu:elizarova}.
%
\include{Dissertation/model_anpa_decompose}
%
Исходя из данных, представленных в таблицах \ref{tbl:model_anpa_objects}, \ref{tbl:model_anpa_informations}, \ref{tbl:model_anpa_actions}
строятся матрицы $A, B$.
Взаимосвязь \textbf{объектов} и \textbf{функций} представляется матрицей $A$,
а \textbf{функций} и \textbf{действий} --- матрицей $B$:
%
\begin{equation}
    A = \begin{pmatrix}
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 &1 & 0 & 0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
        0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
        1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 \\
        1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 \\
        0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 \\
        0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 \\
    \end{pmatrix},
%
    B = \begin{pmatrix}
        0 & 0 & 0 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 1 & 0 \\
        0 & 0 & 0 & 1 & 1 & 0 \\
        0 & 0 & 0 & 1 & 1 & 0 \\
        0 & 0 & 0 & 1 & 1 & 0 \\
        0 & 0 & 0 & 1 & 1 & 0 \\
        1 & 0 & 0 & 0 & 1 & 0 \\
        1 & 1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 1 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 & 0 & 1 \\
        0 & 0 & 1 & 0 & 0 & 1 \\
        1 & 0 & 0 & 0 & 1 & 0 \\
    \end{pmatrix}\,.
\end{equation}

В результате умножения матриц $A$ и $B$ получаем матрицу $C_1$ размера $(6\times14)$,
которая определяет использование сущностей материальной составляющей предметной области действий, найденных через функции:

\begin{equation}
    C_1 = A \times B = \begin{pmatrix}
        1 & 0 & 0 & 1 & 2 & 0 \\
        1 & 1 & 0 & 1 & 1 & 0 \\
        2 & 1 & 0 & 2 & 3 & 0 \\
        0 & 0 & 0 & 2 & 2 & 0 \\
        2 & 3 & 0 & 0 & 2 & 1 \\
        0 & 0 & 3 & 0 & 0 & 1 \\
        0 & 1 & 1 & 1 & 1 & 1 \\
        0 & 1 & 1 & 1 & 1 & 1 \\
        0 & 0 & 0 & 1 & 1 & 0 \\
        0 & 3 & 3 & 0 & 0 & 3 \\
        0 & 3 & 3 & 0 & 0 & 3 \\
        0 & 1 & 1 & 0 & 0 & 2 \\
        1 & 0 & 0 & 5 & 6 & 0 \\
        2 & 1 & 0 & 0 & 1 & 0 \\
    \end{pmatrix}.
\end{equation}

Если $c_{1ik} = 0$, то сущность с номером $i$ не используется в функции с номером $k$ данной функции,
а если $c_{1ik} \ne 0$, то используется.

Построчное суммирование элементов матрицы $C_1$ получаем матрицу $C_2$, показывающую количественные характеристики
использования сущностей материальной составляющей предметной области в функциях:

\begin{equation*}
    C_2 = \begin{pmatrix}
        c_{21} = \sum_{j=1}^l c_{11j} \\
        \ldots \\
        c_{2m} = \sum_{j=1}^l c_{1mj} \\
    \end{pmatrix} 
    =
    \begin{pmatrix}
        4 \\
        4 \\
        8 \\
        4 \\
        8 \\
        4 \\
        5 \\
        5 \\
        2 \\
        9 \\
        9 \\
        4 \\
        12 \\
        4 \\
    \end{pmatrix}.
\end{equation*}
где $c_{2i}$ количество функций, в которых используется данная сущность.

Делением матрицы $C_2$ на число $l = 6$, равное количеству действий в функциональной модели, получаем матрицу $C_3$,
содержащую относительные коэффициенты использования сущностей в действиях:
\begin{equation}
    C_3 = C_2 / l = \begin{pmatrix}
        0,67 \\
        0,67 \\
        \textbf{1,33} \\
        0,67 \\
        \textbf{1,33} \\
        0,67 \\
        0,83 \\
        0,83 \\
        0,33 \\
        \textbf{1,50} \\
        \textbf{1,50} \\
        0,67 \\
        \textbf{2,00} \\
        0,67 \\
    \end{pmatrix}.
\end{equation}
Установив пороговое значение $K_{min} = \overline{C_3} = 0.98$ получаем, что общесистемными являются
\textit{блок управления батареей (2.0);
    рулевые машинки, рулевой привод (1.5);
    анализатор приемо-излучательного тракта СПО и установщик курса (1.33)}.



\subsection{Обоснование типов имитируемых сигналов}

\subsubsection{Имитация внешнего окружения}\label{sec:model_anpa:outer_params}
Ко внешним параметрам среды в рассматриваемой модели относится
глубина хода АНПА, эхо-сигнал в ответ на зондирующую посылку,
поступающий на \textit{приемник} и обрабатываемый \textit{анализатором приемо-излучающего тракта} АНПА.
Значение глубины меняется в пределах $h \in [0, h_{max}]$, где $h_{max}$ -- максимально допустимая глубина погружения АНПА.
АНПА должен следовать на заданной глубине, обусловленной внутренними алгоритмами объекта контроля.
Контроль глубины осуществляется с помощью гидравлической системы,
показания с которой считываются аналоговым датчиком глубины и преобразуются АЦП в цифровой сигнал.
В общем случае гидравлическая система управляется системой контроля,
по заранее определенному алгоритму, соответствующему выбранному режиму проверки.

Таким образом имитация глубины хода АНПА производится по заданному сценарию
после выполнения условий, например, наличие тока потребления
и на произвольный набор моментов времени $\{t_1, t_2, \ldots, t_n\}$
происходит изменение глубины $\{h_1, h_2, \ldots, h_n\}$, соответственно.


Предполагается, что ПУ формирует управляющую команду $s_j$ испускаемого сигнала на внутренней шине данных,
которому ставится в соответствие множество допустимых ответов $s_j \Rightarrow \{r_j\}, r_j = \{r_{j1}, r_{j2}, \ldots, r_{jn}\}$.
В процессе имитации работы подменяются ответы $r_{ji}$.

Управляющая последовательность бит $s_j$, физически представляющая цифровой сигнал напряжением $|U_{\longrightarrow}|$.
Ответная последовательность бит $r_j$, напряжением $|U_{\longleftarrow}| < |U_{\longrightarrow}|$:
СК анализирует правильность ответа $r_j$ на воздействие $s_j$,
также анализируется величина тока, при $I_{\longleftarrow} \geq I_{min}$ биты в ответе $r_j$ считаются равными логической единице.
Цикл команд $s_j \Rightarrow r_j$ продолжается до конца выполнения выбранной задачи или до досрочной остановки.

Невыполнение заданной управляющей команды $s_j$ в течении заданного времени $t_{\mbox{max}}$,
подсистемы СПО АНПА считается аварийным.

Выдача определенного слова должна происходить при выполнении конечного множества условий как с задержкой, так и без нее.


\subsubsection{Имитация внутренних параметров АНПА}\label{sec:model_anpa:inner_params}
\textbf{Напряжение от АКБ.}
Информация о напряжениях \textit{модулей питания} АКБ $U_k, k\in [1..N]$ представляется вещественным числом,
для каждого модуля определяется допустимый диапазон напряжений $U_k \in [U_k^{min}, U_k^{max}]$,
выход за пределы которого считается аварийным и функционирование АНПА не допускается.

\textbf{Ток потребления абонентами АНПА.}
Суммарный ток потребления в имитационной модели определяется как сумма $I_\Sigma = \sum_k I_k + \hat I$,
где токи контролируемых $N$ узлов системы $I_k,\, k\in[1..N]$ и $\hat I$ --- ток узлов не подлежащих контролю (не описанные в модели или флуктуации),
являются аналоговыми реакциями. % $A^r_{out}$.

Допустимый диапазон изменений токов $k$-го узла $I_k \in [I_k^{min}, I_k^{max}]$ определяется из электрической схемы бортовой сети АНПА.
Аналогично $\hat I \in [\hat I^{min}, \hat I^{max}]$ находится в неком диапазоне.
Следовательно суммарный ток потребления АНПА также имеет некое распределение $I_\Sigma \in [I_\Sigma^{min}, I_\Sigma^{max}]$.

Выход одного параметров из допустимого диапазона $I_\Sigma, I_k, \hat I$ считается аварийным режимом работы АНПА.

Выдача определенного напряжения и тока должны происходить при выполнении определенных условий,
например, таких как инициализация некой заданной программы работы АНПА, которая
отождествляется с набором управляющих воздействий и ответных реакций на них.
Таким образом, достаточно следить за конечным набором параметров и
имитировать напряжения и токи моментально или с некой задержкой $\tau$.

\textbf{Работа СУД.}
Согласно выбранной программе проверки на СК вырабатывается соответствующая 
частота $f$ вращения вала \textit{двигателя} в виде ШИМ сигнала.
Из АНПА возвращается периодический сигнал о прохождении определенной дистанции (метка кратного прохождения $m$ метров).
Выход периода $T \in [T^{min}, T^{max}]$ или скважности $Q \in [Q^{min}, Q^{max}]$ из допустимых диапазонов
СК рассматривается как аварийный режим.

ПУ обменивается целочисленными управляющими командами в формате запрос-ответ с СУД по шине данных, в частности с БУД,
для установки необходимого режима работы \textit{двигателя}.

Таким образом имитация вращения валов винтов производится выработкой прямоугольного сигнала с заданным периодом $T$ и скважностью $Q$,
аналогично --- имитация генерации АНПА метки $m$ пройденной дистанции
(увеличение контролируемого параметра на заданную величину $\delta \in \mathcal{R}$ с периодичностью $T_m$ в течении времени $\tau$).

\textbf{Работа рулевой системы.}
ПУ устанавливает заданные курс и глубину в следствии чего подсистема РП
осуществляет перекладку рулей, по средствам \textit{рулевых машинок}.
Информация с РМ может быть получена различными способами, в зависимости от их конструктивного исполнения.
Это может быть напряжение с потенциометров обратной связи, которое обрабатывается в БГР системы контроля
и передается в виде преобразованного цифрового сигнала
либо это может быть изначально  цифровой сигнал.

При проектировании АНПА устанавливается соответствие между $\langle s_j, \{r_j\} \rangle \Rightarrow \omega_i = \omega_i(s_j, \{r_j\}), i\in [1..N]$,
где $s_j, r_j$ -- управляющие и ответные последовательности из раздела \ref{sec:model_anpa:outer_params},
$\omega_i$ -- заданные перекладки рулей для $N$ рулевых машинок.
Если на воздействие $s_j$ приходит ответ $r_{ji} \in \{r_j\}$, в котором содержится информация о том что,
поисковая цель находится по курсу $\bar \omega$, то должны быть установлены соответствующие значения перекладок рулей,
которые приведут к изменению курса (и/или глубины) для оптимального достижения поисковой цели.

