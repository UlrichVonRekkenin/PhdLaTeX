\chapter{Онтология обобщенной информационной модели}
В данном разделе приводится обобщенное описание онтологии и описание четырехуровневой модели данных,
необходимых для анализа при создании программного обеспечения имитатора абонентов сети Modbus
для систем, критичным к ошибкам (mission-critical),
где отказ или срыв одного из факторов приведет к серьезному воздействию на бизнес-операции или на организацию
и даже может вызвать социальные потрясения и катастрофы.

Так например, \textit{серия крушений новейших самолетов Boeing~737~MAX.}
Крушение самолётов Boeing~737~MAX из-за ошибки в некорректной работе системы
MCAS\footnote{Maneuvering Characteristics Augmentation System --- система улучшения летных характеристик.},
призванной \underline{незаметно} помогать пилоту управлять самолётом в ручном режиме (при отключении автопилота),
вместо этого при неисправности одного из датчиков угла атаки MCAS принудительно отправила авиалайнер в пике
(две катастрофы, общее количество жертв 346:
    29~октября 2018~года возле Джакарты --- 189~человек;
    10~марта 2019~года в Эфиопии --- 149~пассажиров и 8~членов экипажа).
Убытки корпорации в первой половине 2020~года порядка 15~млрд долларов;
компенсация семьям погибших в 2019~году --- 5.6~млрд долларов;
в конце января 2020~года переговоры с банками о взятии займа на сумму в 10~млрд долларов для покрытия убытков от приостановки полетов Boeing~737~MAX;
порядка 5~млрд долларов на переподготовку пилотов на тренажерах перед возобновлением эксплуатации авиалайнеров;
отставка генерального директора корпорации Денниса Мюленбурга.

Или \textit{передозировка вызванная аппаратом Therac-25.}
Аппарат лучевой терапии Therac-25 стал причиной как минимум шести передозировок радиации (июнь 1985 --- январь 1987 гг.),
некоторые пациенты получили дозы в десятки тысяч рад. Как минимум двое умерли непосредственно от передозировок \cite{journal:computer:1993:therac25}.
Внешний вид прибора показан на рисунке \ref{app:fig:therac25}.

Или \textit{катастрофа при первом полете Ariane~5.}
Первый испытательный полет в 1996 году Ariane~5
\cite{journal:open_system:1998_adjaev}\footnote{\url{http://www.osp.ru/os/1998/06/179592}},
европейской одноразовой тяжёлой ракеты-носителя семейства Ариан,
предназначенной для выведения полезной нагрузки на низкую опорную орбиту или геопереходную орбиту. 
Ракета-носитель была подорвана на 34-й секунде полёта по причине неисправности в управляющем программном обеспечении.
Конвертация данных из 64-разрядного числа с плавающей запятой в 16-разрядное привела к зависанию компьютера.
Процедура на языке \texttt{Ada}, обрабатывающая эту исключительную ситуацию, была отклонена из соображений сохранения производительности системы.
Это считается самой дорогостоящей компьютерной ошибкой в истории.
Отметим, что всю цепь событий удалось полностью воспроизвести с помощью компьютерного \underline{моделирования},
что вкупе с материалами других исследований и экспериментов позволило полностью выявить причины и обстоятельства катастрофы.

% \textbf{Блэкоут.}
% В 2003 году\footnote{\url{https://m.habr.com/ru/company/mailru/blog/370153/}}.
% \textbf{Третья мировая война.} % https://m.habr.com/ru/company/mailru/blog/485612
% Запуск балистических ракет в 1983 году (там же).
% \textbf{Перелет через линию смены дат.}
% Смена часового пояса у истребителей F-22. 



\section{Теоретико-модельная формализация предметной области}\label{sec:ontology}

Онтологическое моделирование и построение теории предметной области состоит из следующих этапов:
\begin{enumerate*}[label=\arabic*\upshape)]
    \item определение множества ключевых понятий;
    \item описание смысла ключевых понятий;
    \item задание аксиом, эмпирических постулатов;
    \item формальное представление множества реальных прецедентов;
    \item порождение оценочных (нечетких) знаний о предметной области на основе анализа множества прецедентов предметной области
        \cite{journal:philosopy_nauki:palchunov}.
\end{enumerate*}
Следуя положениям, изложенным в работах \cite{journal:vestnic_novosib:palchunov, journal:naukovedenie:serdukov},
введем следующие понятия.

\textbf{Сигнатура предметной области.}
В данной работе рассматривается предметная область, содержащая обмен данными по промышленной сети Modbus,
и выполнение неких действий при достижении условий -- в формализации предметной области используются только понятия-свойства,
описывающие конкретные данные, передаваемые по сети. Все понятия делятся на три класса:

\begin{itemize}
    \item $\mathbb{T}$ --- класс первичных данных, передаваемых по сети (теги из листинга \ref{lst:modbus_tags_example} приложения \ref{app:sec:modbus_tag}).
        Понятия этого класса используются для построения множества допустимых элементов сценария работы имитатора;
    % 
    \item $\mathbb{C}$ --- класс отношений данных (используется при принятии решений об изменении состояния отслеживаемого параметра).
        Понятия этого класса используются, например, в листинге \ref{lst:comparator:compare}.
    %
    \item $\mathbb{A}$ --- класс всех возможных изменений отслеживаемого параметра (в сценарии перехода один и тот же параметр может фигурировать в разных ролях).
        Понятия этого класса используются в построении сценариев, как показано в листинге \ref{lst:modbus_scenario_example_diagram} приложения \ref{app:sec:modbus_scenario_example_diagram}.
\end{itemize}

Таким образом рассматривается сигнатура, состоящая из конечного числа одноместных предикатных символов \cite[стр. 17]{book:math_logic:guz}.
Далее сигнатуру предметной области $\Delta$ будем обозначать через $\sigma_\Delta$.
Как указано выше, $\sigma_\Delta = \mathbb{T} \cup \mathbb{C} \cup \mathbb{A}$.
Предикаты $P(x) \in \sigma_\Delta$ будем называть \textit{сигнатурными предикатами}.
Через $S(\sigma_\Delta)$ будем обозначать множество всех одноместных бескванторных формул сигнатуры $\sigma_\Delta$.
Заметим, что каждая формула $\varphi(x) \in S(\sigma_\Delta)$ является булевой комбинацией сигнатурных предикатов.


\textbf{Онтология предметной области.}
Для успешного построения образа имитационной модели необходима онтология $S$ предметной области
диспетчерской деятельности $T$ \cite{journal:vestnik_spbgu:ivakin, journal:vestnik_vgtu:shapkin},
в наиболее общем ее понимании, есть совокупность основных понятий этой деятельности $H$ и связей между ними $\Theta$:
$S=\langle H, \Theta\rangle$. 

Для описания онтологии предметной области задается конечное множество аксиом $\mathcal{A}x(\Delta) \subseteq S(\sigma_\Delta)$.
  
\textit{Аксиома общего-частного.}
Иерархическая упорядоченность некоторых понятий должна быть отображена аксиоматически (например, последовательность тегов Modbus, приведенная в листинге \ref{lst:modbus_tags_example}).
Схема таких аксиом следующая: $\left(P_1(x) \to P_2(x) \right)$.
Например: <<Если тег \texttt{C1} \textit{Внешнее питание}, то запись 1 бита со значением \texttt{true} по указанному адресу приведет к включению внешнего питания>>.

\textit{Аксиомы исключения.}
Некоторые понятия являются взаимоисключающими. Схема таких аксиом следующая:
$\left(P_1(x) \to \lnot P_2(x) \right)$.
Например:
«Если установлен \textit{режим работы} \texttt{Regime} = 1, то не верно, что \textit{режим работы} \texttt{Regime} равен 2»
или
<<Если \textit{внешнее питание} \texttt{C1} не включено, то \textit{напряжение} и \textit{ток} двигателя \texttt{A1} и \texttt{A2} равны нулю, соответственно>>.

\textit{Аксиома полноты.}
Для описания предметной области рассматривается совокупность допустимых изменений отслеживаемых параметров,
указанных в конфигурационном файле сценария. При этом считается, что в каждом рассматриваемом эпизоде сценария
отражено хотя бы по одному признаку из каждого из трех рассматриваемых классов.
Таким образом, имеется следующая аксиома полноты:
$$%
\left( \left(\bigvee_{P\in\mathbb{T}}P(x)\right) \& \left(\bigvee_{P\in\mathbb{C}}P(x)\right) \& \left(\bigvee_{P\in\mathbb{A}}P(x)\right) \right) \,.
$$

Упорядоченная пара $\langle\sigma_\Delta, \mathcal{A}x(\Delta)\rangle$ образует \textit{онтологию} предметной области $\Delta$.
Эта онтология является подмножеством \textit{аналитической теории} предметной области $\Delta$.


\textit{Онтологическая модель предметной области.}
Далее рассмотрим конечное множество $\left\{ s_1, \ldots, s_n \right\}$ правил перехода (подсценариев) в сценарии.
Правило перехода $s_i$ --- это структурированное описание (см. листинг \ref{lst:modbus_scenario_example_diagram} приложения \ref{app:sec:modbus_scenario_example_diagram}).
Заметим, что в правиле перехода однозначно указаны 
\begin{enumerate*}[label=\arabic*\upshape)]
    \item все необходимые условия для выполнения действия,
    \item указан ресурс который должен быть изменен,
    \item значение, которое должно быть присвоено этому ресурсу и
    \item пределы изменения захваченной величины.
\end{enumerate*}
Таким образом для $\forall s_i$ возможно описать множество признаков (сигнатурных предикатов), истинных на $s_i$.
Таким образом, для каждого правила перехода строится одноэлементная модель $s_i = \langle \{s_i\}, \sigma_\Delta \rangle$,
которая называется \textit{прецедентом} предметной области $\Delta$.

Для построения онтологической модели необходимо рассмотреть конечное множество 
$\mathbb{S}=\left\{ s_1, \ldots, s_m \right\}$ прецедентов предметной области.
Заметим, что возможны случаи, когда для некоторых $i,j \in \left\{1,\ldots,m\right\} (i\ne j)$
модели $s_i$, $s_j$ будут изоморфны (напряжение и ток двигателя появляется только при выполнении условия $R1 = \mbox{true}$).
Тем не менее эти модели учитываются как формализации различных прецедентов.
Необходимым условием, накладываемым на прецеденты, является истинность на них аналитической теории предметной области.
С теоретико-модельной точки зрения это, в частности, означает, что на каждой модели $s_i$ должно быть истинным множество аксиом
$\mathcal{A}x(\Delta)$, то есть $s_i \vDash \mathcal{A}x(\Delta)$.

Однако, не каждая одноэлементная модель аналитической теории, является прецедентом предметной
области (нельзя обуславливать срабатывание узлов PP\_1 и PP\_2 наличием напряжения на двигателе).
Выбор тех или иных моделей в качестве прецедентов и задает структуру онтологической модели
$\mathfrak{U}_\Delta =\langle \mathbb{S}, \sigma_\Delta \rangle$.
В онтологической модели $\mathfrak{U}_\Delta$ для каждого сигнатурного предиката $P(x) \in \sigma_\Delta$
и для каждого прецедента $s_i \in \mathbb{S}$ имеем $\mathfrak{U}_\Delta \vDash P(s_i)$
тогда и только тогда, когда $s_i \vDash P(s_i)$.
Заметим, что если формула $\varphi(x) \in S(\sigma_\Delta)$ принадлежит множеству аксиом предметной
области $\Delta$, то для $\forall s_i \in \mathbb{S}$  имеет место $\mathfrak{U}_\Delta \vDash\varphi(s_i)$.
Таким образом, на онтологической модели является истинной онтология данной предметной области,
более того, онтологическая модель принадлежит классу моделей аналитической теории предметной области.

Очевидно что одной из особенностей имитационной модели является отсутствие четких границ области применения.
Это означает, что в прогнозируемый период жизненного цикла системы круг решаемых ею задач будет изменяться и расширяться,
что не позволяет четко описать требования к системе, перечислить всю совокупность классов предметной области и
написать программу их реализации.

\section{Четырехуровневая модель метаданных}
Устранение этих недостатков возможно при использовании концепции четырехуровневой модели метаданных (это данные, описывающие организацию других данных),
приведенной в таблице~\ref{tbl:meta_data_levels} \cite{journal:vestnik_spbgu:ivakin,book:gost:56272,w3c:rdf:lassila}.
\begin{longtable}{|c|c|p{.6\textwidth}|}
    \caption{Четырехуровневая модель метаданных}\label{tbl:meta_data_levels} \\
    \hline\textbf{Уровень} & \textbf{Название} & \textbf{Пример} \\\hline\endhead
    %
    3 & Мета-метакласс & RDF \\\hline
    %
    2 & Метакласс & Метакласс (Класс~метаатрибут (имя-строка)...) \\\hline
    %
    1 & Класс & Класс (``Стимул``, [\\
                &&\hspace{5mm}поле (``обозначение``, строка), \\
                &&\hspace{5mm}поле (``назначение``, строка), \\
                &&\hspace{5mm}поле (``значение``, число),\\
                &&\hspace{5mm}поле (``адрес``, число),\\
                &&\hspace{5mm}поле (``тип данных``, число)\\
                &&\hspace{5mm}поле (``единицы измерений``, строка)\\
            &&]);\\
            %
            &&Класс (``Запись при условии'', [\\
                &&\hspace{5mm}поле (``обозначение'', строка),\\
                &&\hspace{5mm}поле (``значение'', число),\\
                &&\hspace{5mm}поле (``условия'', логическое выражение)\\
            &&])\\\hline
    %
    0 & Объект & 
        \texttt{C1} (Внешнее питание, \texttt{true}, 8001); \\
        %
        &&\texttt{W} (Имитация напряжения двигателя, 130~В, $C1 \equiv \mbox{true} \wedge \tau|_{C1\equiv\mbox{true}} \ge 500\mbox{ms}$).
        \\\hline
\end{longtable}


\section*{Заключение}
В заключении отметим, что необходимость разработки онтологии связана~с:
\begin{enumerate*}[label=\arabic*\upshape)]
    \item совместным использованием данных людьми или программными компонентами;
    \item общего понимания структуры информации;
    \item возможности повторного использования знаний в предметной области;
    \item чтобы сделать допущения в предметной области явными;
    \item отделение знаний предметной области от оперативных;
    \item анализ знаний предметной области.
\end{enumerate*}

Проиллюстрируем это утверждение при определении типов и правил преобразования
значений Modbus в разделах \ref{sec:modbus_tag} и \ref{sec:writers_relationship} соответственно.
Далее рассмотрим положения, изложенные в таблице \ref{tbl:meta_data_levels}, более детально применительно к переменным протокола Modbus.
